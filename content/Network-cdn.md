+++
title = "ç½‘ç»œè‰ºæœ¯:CDNæŠ€æœ¯ä¸åº”ç”¨"
date = 2024-02-16

[taxonomies]
tags = ["Network"]
+++

å‰è¨€ å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰æ˜¯ä¸€ç»„åˆ†å¸ƒåœ¨ä¸åŒåœ°ç†ä½ç½®çš„æœåŠ¡å™¨ç½‘ç»œ,ä½¿ç”¨æˆ·èƒ½å¤Ÿå°±è¿‘è·å–å†…å®¹ï¼Œä»è€Œé™ä½å»¶è¿Ÿå¹¶ç¼“è§£æºç«™å‹åŠ›â€‹.

<!-- more -->

## ä»€ä¹ˆæ˜¯CDNï¼Ÿ

å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰æ˜¯ä¸€ç»„åˆ†å¸ƒåœ¨ä¸åŒåœ°ç†ä½ç½®çš„æœåŠ¡å™¨ç½‘ç»œï¼Œæ—¨åœ¨å°†ç½‘ç«™æˆ–åº”ç”¨çš„é™æ€èµ„æºï¼ˆå¦‚HTMLã€å›¾ç‰‡ã€è§†é¢‘ç­‰ï¼‰ç¼“å­˜åˆ°è·ç¦»ç”¨æˆ·æ›´è¿‘çš„èŠ‚ç‚¹ï¼Œä»¥ç¼©çŸ­ä¼ è¾“è·¯å¾„ã€é™ä½å¸¦å®½æˆæœ¬å¹¶æé«˜è®¿é—®é€Ÿåº¦â€‹.CDNé€šè¿‡â€œç¼“å­˜â€æœºåˆ¶ï¼Œåœ¨å…¨çƒå¤šä¸ªæ•°æ®ä¸­å¿ƒä¸´æ—¶å­˜å‚¨å†…å®¹å‰¯æœ¬ï¼Œç”¨æˆ·å‘èµ·è¯·æ±‚æ—¶æ— éœ€å›æºåˆ°ä¸»æœåŠ¡å™¨ï¼Œå°±èƒ½ä»æœ€è¿‘çš„ç¼“å­˜èŠ‚ç‚¹è·å–æ•°æ®ï¼Œä»è€Œæ˜¾è‘—æ”¹å–„é¡µé¢åŠ è½½æ—¶é—´å’Œæ•´ä½“ç”¨æˆ·ä½“éªŒâ€‹.ç›¸æ¯”ä¼ ç»Ÿçš„å•ç‚¹æºç«™è®¿é—®ï¼ŒCDNåœ¨ç”¨æˆ·å’Œæºç«™ä¹‹é—´å¢åŠ äº†åˆ†å±‚ç¼“å­˜ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡æŠ€æœ¯å’Œæ™ºèƒ½è·¯ç”±ï¼Œå°†è®¿é—®è¯·æ±‚å®šå‘åˆ°æœ€ä¼˜èŠ‚ç‚¹ï¼Œæ—¢å‡è½»äº†æºç«™å‹åŠ›ï¼Œåˆæå‡äº†ç½‘ç»œæŠ—æ‹¥å¡èƒ½åŠ›å’Œå¯ç”¨æ€§â€‹.

åœ¨ç°ä»£äº’è”ç½‘ä¸­ï¼Œå†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰å’ŒåŸŸåç³»ç»Ÿï¼ˆDNSï¼‰ç›¸äº’é…åˆï¼Œå…±åŒæå‡äº†ç½‘é¡µå’Œå¤šåª’ä½“å†…å®¹çš„è®¿é—®é€Ÿåº¦ä¸å¯é æ€§.CDNé€šè¿‡åœ¨å…¨çƒåˆ†å¸ƒçš„ç¼“å­˜èŠ‚ç‚¹ä¸Šå­˜å‚¨é™æ€èµ„æºï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå°±è¿‘è·å–å†…å®¹ï¼Œä»è€Œé™ä½å»¶è¿Ÿå¹¶ç¼“è§£æºç«™å‹åŠ›â€‹.è€ŒDNSåˆ™è´Ÿè´£å°†ç”¨æˆ·çš„åŸŸåè¯·æ±‚å¯¼å‘é€‚å½“çš„CDNèŠ‚ç‚¹ï¼Œé€šè¿‡CNAMEé‡å®šå‘ã€å…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰ã€AnycaståŠEDNSæ‰©å±•ç­‰æŠ€æœ¯ï¼Œå®ç°æ™ºèƒ½åŒ–çš„æµé‡è°ƒåº¦å’Œæœ€ä¼˜è·¯å¾„é€‰æ‹©â€‹.

**CDNçš„æ ¸å¿ƒåŠŸèƒ½ä¸ä¼˜åŠ¿**

- åŠ é€Ÿè®¿é—®ï¼šå°†å†…å®¹å­˜å‚¨äºè·ç¦»ç”¨æˆ·æ›´è¿‘çš„èŠ‚ç‚¹ï¼Œå‡å°‘ä¼ è¾“å»¶è¿Ÿï¼Œå¸¸è§äºè§†é¢‘ç‚¹æ’­ã€å¤§æ–‡ä»¶ä¸‹è½½ç­‰åœºæ™¯â€‹.

- å‡è½»æºç«™å‹åŠ›ï¼šç¼“å­˜è¯·æ±‚å¯ç›´æ¥ç”±CDNèŠ‚ç‚¹å“åº”ï¼Œé™ä½æºç«™å¸¦å®½å’Œè®¡ç®—èµ„æºæ¶ˆè€—ï¼Œæœ‰åŠ©äºåº”å¯¹çªå‘æµé‡å’ŒDDoSæ”»å‡»â€‹.

- é«˜å¯ç”¨ä¸å¼¹æ€§æ‰©å±•ï¼šå…¨çƒåˆ†å¸ƒçš„èŠ‚ç‚¹æ¶æ„ï¼Œä½¿å†…å®¹åˆ†å‘å…·å¤‡å†—ä½™èƒ½åŠ›ï¼Œå•ç‚¹æ•…éšœä¸ä¼šå½±å“æ•´ä½“æœåŠ¡ï¼Œä¸”å¯åŠ¨æ€æ‰©å®¹ä»¥åº”å¯¹ä¸šåŠ¡å¢é•¿.

## CDNä¸DNSçš„ç»“åˆæ–¹å¼

1. **é€šè¿‡CNAMEå®ç°æƒå¨DNSæŒ‡å‘CDN**

å½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥åŸŸåå‘èµ·è¯·æ±‚æ—¶ï¼Œé¦–å…ˆè§¦å‘æœ¬åœ°DNSè§£æè¿‡ç¨‹ï¼›å¦‚æœè¯¥åŸŸåå·²å¼€é€šCDNæœåŠ¡ï¼Œå…¶DNSè§£æè®°å½•é€šå¸¸é…ç½®ä¸ºä¸€æ¡CNAMEï¼ˆåˆ«åï¼‰è®°å½•ï¼ŒæŒ‡å‘CDNè¿è¥å•†æä¾›çš„ä¸“ç”¨åŸŸåï¼›æœ¬åœ°DNSæœåŠ¡å™¨å†å°†è§£ææƒäº¤ç»™CDNçš„æƒå¨DNSæœåŠ¡å™¨ï¼Œä»è€Œå®ç°å¯¹CDNç½‘ç»œçš„æ¥å…¥â€‹.


CDNçš„æƒå¨DNSæœåŠ¡å™¨æ ¹æ®ç”¨æˆ·è¯·æ±‚çš„åŸŸåï¼Œè¿”å›ä¸€ä¸ªâ€œå…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡â€çš„IPåœ°å€ï¼Œè¯¥IPå¹¶éæœ€ç»ˆç¼“å­˜èŠ‚ç‚¹ï¼Œè€Œæ˜¯GSLBå±‚ç”¨äºæ™ºèƒ½è°ƒåº¦çš„å…¥å£åœ°å€ï¼›æµè§ˆå™¨æ¥æ”¶åˆ°è¯¥IPåï¼Œå‘GSLBå±‚å‘èµ·å®é™…å†…å®¹è¯·æ±‚â€‹.

2. **å…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰ä¸æ™ºèƒ½DNS**

GSLBï¼ˆGlobal Server Load Balancingï¼‰æ˜¯CDNæ¶æ„ä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼Œè´Ÿè´£æ ¹æ®å¤šç§å› ç´ ï¼ˆç”¨æˆ·IPåœ°ç†ä½ç½®ã€èŠ‚ç‚¹å¥åº·çŠ¶æ€ã€èŠ‚ç‚¹è´Ÿè½½æƒ…å†µç­‰ï¼‰åŠ¨æ€é€‰æ‹©æœ€ä¼˜åŒºåŸŸè´Ÿè½½å‡è¡¡èŠ‚ç‚¹æˆ–ç¼“å­˜æœåŠ¡å™¨ï¼Œå‘ç”¨æˆ·æä¾›æœ€ä½å»¶è¿Ÿå’Œæœ€ä½³æ€§èƒ½çš„æœåŠ¡â€‹.

è¿™ä¸€è¿‡ç¨‹é€šå¸¸ä¹ŸåŸºäºDNSè§£æå®Œæˆï¼šå½“GSLBå±‚æ¥åˆ°DNSæŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œæ™ºèƒ½DNSæœåŠ¡å™¨ä¼šè¿”å›é’ˆå¯¹è¯¥ç”¨æˆ·æœ€ä¼˜çš„ç¼“å­˜èŠ‚ç‚¹IPï¼Œä»è€Œå®ç°â€œDNSçº§â€çš„æµé‡è°ƒåº¦å’Œè´Ÿè½½å‡è¡¡â€‹.

3. **Anycastä¸EDNSæ‰©å±•**

Anycastè·¯ç”±ï¼šéƒ¨åˆ†CDNè¿è¥å•†åœ¨å…¨çƒéƒ¨ç½²ç›¸åŒIPçš„å¤šä¸ªèŠ‚ç‚¹ï¼Œåˆ©ç”¨BGP AnycastæŠ€æœ¯ä½¿å¾—ç”¨æˆ·è¯·æ±‚è‡ªåŠ¨è·¯ç”±åˆ°ç½‘ç»œæ‹“æ‰‘ä¸Šâ€œæœ€è¿‘â€çš„èŠ‚ç‚¹ï¼Œå¢å¼ºè®¿é—®çš„ç½‘ç»œè·¯å¾„æ•ˆç‡ä¸å®¹ç¾èƒ½åŠ›â€‹.

EDNS Client Subnetï¼ˆEDNS-CSï¼‰ï¼šä¼ ç»ŸDNSä»…çœ‹åˆ°å‘èµ·æŸ¥è¯¢çš„é€’å½’DNSæœåŠ¡å™¨IPï¼Œéš¾ä»¥å‡†ç¡®åˆ¤æ–­ç»ˆç«¯ç”¨æˆ·ä½ç½®ï¼›EDNS-CSåè®®åœ¨DNSè¯·æ±‚ä¸­æºå¸¦éƒ¨åˆ†å®¢æˆ·ç«¯IPå‰ç¼€ï¼Œä½¿æƒå¨DNSèƒ½æ›´ç»†ç²’åº¦åœ°è¿›è¡Œåœ°ç†å®šä½ä¸èŠ‚ç‚¹é€‰å–ï¼Œå¤§å¹…æå‡äº†åŸºäºDNSçš„æ™ºèƒ½è°ƒåº¦ç²¾åº¦â€‹.



## ä¸ºä»€ä¹ˆåŠ äº†CDNä¹‹åç½‘ç«™çš„è‡ªç­¾åè¯ä¹¦ä¹Ÿè¢«ä¿¡ä»»äº†ï¼Ÿ

> åœ¨å¯ç”¨ CDN åï¼Œç»ˆç«¯ç”¨æˆ·çœ‹åˆ°çš„å¹¶ä¸æ˜¯æ‚¨åœ¨æºç«™ï¼ˆoriginï¼‰ä¸Šé…ç½®çš„è‡ªç­¾åè¯ä¹¦ï¼Œè€Œæ˜¯ CDN è¾¹ç¼˜èŠ‚ç‚¹ï¼ˆedgeï¼‰æ‰€å‡ºç¤ºçš„ã€ç”±å—ä¿¡ä»» CA ç­¾å‘çš„â€œè¾¹ç¼˜è¯ä¹¦â€.ä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨ä¸ CDN è¾¹ç¼˜ä¹‹é—´çš„ TLS æ¡æ‰‹å®Œå…¨ç‹¬ç«‹äºæ‚¨æºç«™å’Œè‡ªç­¾åè¯ä¹¦çš„å­˜åœ¨ï¼Œæºç«™çš„è‡ªç­¾åè¯ä¹¦ä»…ç”¨äº CDN ä¸æºç«™ä¹‹é—´çš„â€œåç«¯â€åŠ å¯†è¿æ¥ï¼Œä¸ä¼šæš´éœ²ç»™æœ€ç»ˆç”¨æˆ·æµè§ˆå™¨â€‹.


**CDN æ¨¡å¼ä¸‹çš„ TLS ç»ˆæ­¢**

- **DNS/CNAME æŒ‡å‘**
    å½“æ‚¨ä¸ºåŸŸåå¯ç”¨ CDN åï¼Œé€šå¸¸ä¼šåœ¨ DNS ä¸­å°†è¯¥åŸŸåçš„ CNAME è®°å½•æŒ‡å‘ CDN è¿è¥å•†æä¾›çš„ä¸“ç”¨åŸŸåï¼Œæœ¬åœ°é€’å½’ DNS éšåä¼šå°†è§£ææƒäº¤ç»™ CDN ä¾›åº”å•†çš„æƒå¨ DNSï¼Œå®ç°è¯·æ±‚åˆ‡å…¥ CDN ç½‘ç»œâ€‹.

- **è¾¹ç¼˜èŠ‚ç‚¹å‡ºç¤ºè¯ä¹¦**
    ç”¨æˆ·å‘èµ· HTTPS è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ç›´æ¥ä¸å°±è¿‘çš„ CDN è¾¹ç¼˜èŠ‚ç‚¹å»ºç«‹ TLS è¿æ¥ï¼Œè¾¹ç¼˜èŠ‚ç‚¹ä¼šå‡ºç¤ºç”±å—ä¿¡ä»» CAï¼ˆå¦‚ Let's Encryptã€DigiCert ç­‰ï¼‰ç­¾å‘çš„â€œè¾¹ç¼˜è¯ä¹¦â€ï¼Œè€Œéæ‚¨æºç«™çš„è‡ªç­¾åè¯ä¹¦â€‹.

- **æºç«™è¿æ¥åŠ å¯†**
    åœ¨è¾¹ç¼˜èŠ‚ç‚¹æ¥æ”¶å¹¶ç¼“å­˜ç”¨æˆ·æµé‡åï¼ŒCDN å†ä»¥ HTTPSï¼ˆæˆ– HTTPï¼Œæ ¹æ®é…ç½®ï¼‰å‘æºç«™å‘èµ·è¯·æ±‚.æ­¤æ—¶ï¼Œæ‚¨å¯ä»¥åœ¨æºç«™ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼ˆæˆ– Cloudflare Origin CA è‡ªç­¾åè¯ä¹¦ï¼‰ï¼Œä»…ä¿è¯ CDN ä¸æºç«™ä¹‹é—´çš„åŠ å¯†ä¼ è¾“ï¼Œä¸”è¯¥è¯ä¹¦å¯¹ç»ˆç«¯ç”¨æˆ·æµè§ˆå™¨ä¸å¯è§â€‹.

### SSL/TLS åŠ å¯†æ¨¡å¼å¯¹è‡ªç­¾åè¯ä¹¦çš„å½±å“

ä»¥ Cloudflare ä¸ºä¾‹ï¼Œå¸¸è§çš„å››ç§ SSL/TLS æ¨¡å¼å¯¹è‡ªç­¾åè¯ä¹¦çš„å¤„ç†ç­–ç•¥å¦‚ä¸‹ï¼š

- **Flexible**ï¼šæµè§ˆå™¨ â†” CDN è¾¹ç¼˜ ä½¿ç”¨ HTTPSï¼›CDN è¾¹ç¼˜ â†” æºç«™ ä½¿ç”¨ HTTPï¼Œä¸æ¥è§¦è¯ä¹¦éªŒè¯.

- **Full**ï¼šæµè§ˆå™¨ â†” CDN è¾¹ç¼˜ ä½¿ç”¨ HTTPSï¼›CDN è¾¹ç¼˜ â†” æºç«™ ä½¿ç”¨ HTTPSï¼Œä½†ä¸éªŒè¯æºç«™è¯ä¹¦çš„ CA é“¾å’ŒåŸŸååŒ¹é…ï¼Œå¯ä½¿ç”¨è‡ªç­¾åè¯ä¹¦â€‹.
    Cloudflare Docs

- **Full (strict)**ï¼šæµè§ˆå™¨ â†” CDN è¾¹ç¼˜ ä½¿ç”¨ HTTPSï¼›CDN è¾¹ç¼˜ â†” æºç«™ ä½¿ç”¨ HTTPSï¼Œä¸¥æ ¼éªŒè¯æºç«™è¯ä¹¦æ˜¯å¦ç”±å—ä¿¡ä»» CA ç­¾å‘ä¸”åŸŸååŒ¹é…ï¼Œä¸æ”¯æŒè‡ªç­¾åè¯ä¹¦â€‹.
    Cloudflare Docs

- **Off**ï¼šå…³é—­ HTTPSï¼ŒåŠ å¯†æ”¯æŒå®Œå…¨å…³é—­.

è‹¥æ‚¨é€‰æ‹© Full æˆ– Flexible æ¨¡å¼ï¼Œå³ä½¿æºç«™ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼ŒCDN ä¹Ÿä¸ä¼šåœ¨è¾¹ç¼˜å±‚å¯¹å…¶è¿›è¡ŒéªŒè¯ï¼Œä»ä¼šæ­£å¸¸è½¬å‘å’Œç¼“å­˜å†…å®¹ï¼›è€Œç”¨æˆ·æµè§ˆå™¨åªä¼šçœ‹åˆ° CDN è¾¹ç¼˜æä¾›çš„å—ä¿¡ä»»è¯ä¹¦ï¼Œå› æ­¤ä¸ä¼šå‡ºç°â€œä¸å—ä¿¡ä»»â€è­¦å‘Šâ€‹.

> ä¸ºä»€ä¹ˆæµè§ˆå™¨ä¼šä¿¡ä»»? æµè§ˆå™¨å†…ç½®äº†å—ä¿¡ä»»çš„æ ¹è¯ä¹¦åˆ—è¡¨ï¼ŒCDN è¾¹ç¼˜å‡ºç¤ºçš„è¯ä¹¦é“¾ä¼šå®Œæ•´åœ°é“¾æ¥åˆ°æŸä¸ªç³»ç»Ÿä¿¡ä»»æ ¹ï¼Œè€Œæ‚¨çš„è‡ªç­¾åè¯ä¹¦åˆ™ä¸åœ¨æ­¤åˆ—è¡¨å†…ï¼Œå› è€Œåªæœ‰æºç«™è¿æ¥å¯è¢« CDN ä¿¡ä»»ï¼Œè€Œéç»ˆç«¯æµè§ˆå™¨â€‹.CDN åˆ™ä½œä¸ºâ€œå¯ä¿¡ä¸­é—´äººâ€ï¼Œå®ƒä¿¡ä»»è‡ªç­¾åè¯ä¹¦ä»¥åŠ å¯†ä¸æºç«™çš„é€šä¿¡ï¼Œè€Œæµè§ˆå™¨ä»…ä¿¡ä»» CDN è¾¹ç¼˜çš„ CA ç­¾å‘è¯ä¹¦ï¼ŒäºŒè€…äº’ä¸å¹²æ‰°ï¼Œæœ‰æ•ˆéš”ç¦»äº†è‡ªç­¾åçš„é£é™©.


### å¦‚ä½•å¼€å¯Full (Strict)æ¨¡å¼ï¼Ÿ


â€‹è¦åœ¨ Cloudflare ä¸Šå¯ç”¨ Full (Strict) æ¨¡å¼ï¼Œä»¥ç¡®ä¿ CDN ä¸æºç«™ä¹‹é—´çš„é€šä¿¡æ—¢åŠ å¯†åˆéªŒè¯è¯ä¹¦çš„æœ‰æ•ˆæ€§ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼šâ€‹

âœ… æ­¥éª¤ 1ï¼šç¡®ä¿æºç«™é…ç½®äº†æœ‰æ•ˆçš„ SSL/TLS è¯ä¹¦

åœ¨å¯ç”¨ Full (Strict) æ¨¡å¼ä¹‹å‰ï¼Œæ‚¨çš„æºç«™å¿…é¡»å®‰è£…ä¸€ä¸ªæœ‰æ•ˆä¸”å—ä¿¡ä»»çš„ SSL/TLS è¯ä¹¦.â€‹æ‚¨å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ–¹å¼ä¹‹ä¸€ï¼šâ€‹

    ä½¿ç”¨å…¬å…± CA é¢å‘çš„è¯ä¹¦ï¼šå¦‚ Let's Encryptã€DigiCertã€GlobalSign ç­‰.

    ä½¿ç”¨ Cloudflare Origin CA è¯ä¹¦ï¼šè¿™æ˜¯ Cloudflare æä¾›çš„å…è´¹è¯ä¹¦ï¼Œä¸“ä¸ºä¸å…¶è¾¹ç¼˜èŠ‚ç‚¹é€šä¿¡è®¾è®¡.â€‹

ç¡®ä¿è¯ä¹¦æœªè¿‡æœŸï¼Œä¸”åŸŸååŒ¹é…æ­£ç¡®.å¦‚æœä½¿ç”¨ Cloudflare Origin CA è¯ä¹¦ï¼Œè¯·åœ¨æºç«™æœåŠ¡å™¨ä¸Šæ­£ç¡®å®‰è£…ï¼Œå¹¶é…ç½®æœåŠ¡å™¨ï¼ˆå¦‚ Nginxã€Apacheï¼‰ä»¥ä½¿ç”¨è¯¥è¯ä¹¦.â€‹

âœ… æ­¥éª¤ 2ï¼šåœ¨ Cloudflare ä»ªè¡¨æ¿ä¸­å¯ç”¨ Full (Strict) æ¨¡å¼
```
ç™»å½•åˆ°æ‚¨çš„ Cloudflare ä»ªè¡¨æ¿.

é€‰æ‹©æ‚¨è¦é…ç½®çš„ç«™ç‚¹.

åœ¨å·¦ä¾§èœå•ä¸­ï¼Œç‚¹å‡» â€œSSL/TLSâ€.

åœ¨ â€œæ¦‚è§ˆï¼ˆOverviewï¼‰â€ æ ‡ç­¾ä¸‹ï¼Œæ‰¾åˆ° â€œSSL/TLS åŠ å¯†æ¨¡å¼ï¼ˆSSL/TLS encryption modeï¼‰â€.

é€‰æ‹© â€œFull (Strict)â€ æ¨¡å¼.â€‹
```

æ›´æ”¹åï¼ŒCloudflare ä¼šç«‹å³åº”ç”¨æ­¤è®¾ç½®.â€‹å»ºè®®ç­‰å¾…å‡ åˆ†é’Ÿï¼Œç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®æ‚¨çš„ç½‘ç«™ï¼Œç¡®ä¿ä¸€åˆ‡æ­£å¸¸è¿è¡Œ.â€‹

ğŸ”— æ³¨æ„äº‹é¡¹

å¦‚æœæºç«™ä½¿ç”¨çš„æ˜¯è‡ªç­¾åè¯ä¹¦æˆ–è¿‡æœŸçš„è¯ä¹¦ï¼Œå¯ç”¨ Full (Strict) æ¨¡å¼åï¼ŒCloudflare å°†æ— æ³•å»ºç«‹è¿æ¥ï¼Œç”¨æˆ·å¯èƒ½ä¼šçœ‹åˆ° 526 é”™è¯¯.

ç¡®ä¿æºç«™æœåŠ¡å™¨çš„æ—¶é—´è®¾ç½®æ­£ç¡®ï¼Œä»¥é¿å…å› æ—¶é—´ä¸ä¸€è‡´å¯¼è‡´çš„è¯ä¹¦éªŒè¯å¤±è´¥.

## DNSSECæ˜¯ä»€ä¹ˆï¼Ÿ

DNSSECï¼ˆDomain Name System Security Extensionsï¼ŒåŸŸåç³»ç»Ÿå®‰å…¨æ‰©å±•ï¼‰æ˜¯ä¸€ç»„ä¸º DNS åè®®è®¾è®¡çš„å®‰å…¨æœºåˆ¶ï¼Œæ—¨åœ¨é€šè¿‡æ•°å­—ç­¾åéªŒè¯ DNS æ•°æ®çš„çœŸå®æ€§å’Œå®Œæ•´æ€§ï¼Œé˜²æ­¢åŸŸåè§£æè¿‡ç¨‹ä¸­çš„æ•°æ®ç¯¡æ”¹å’Œä¼ªé€ .

1. DNSSEC çš„å·¥ä½œåŸç†

DNSSEC é€šè¿‡å¼•å…¥ä»¥ä¸‹å…³é”®æœºåˆ¶æ¥å¢å¼º DNS çš„å®‰å…¨æ€§ï¼šâ€‹

- æ•°å­—ç­¾åï¼ˆRRSIG è®°å½•ï¼‰ï¼šâ€‹æ¯ä¸ª DNS è®°å½•é›†ï¼ˆå¦‚ Aã€MXã€CNAME ç­‰ï¼‰éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„æ•°å­—ç­¾åï¼Œç¡®ä¿è®°å½•åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœªè¢«ç¯¡æ”¹.â€‹

- å…¬é’¥å‘å¸ƒï¼ˆDNSKEY è®°å½•ï¼‰ï¼šâ€‹ç”¨äºå­˜å‚¨éªŒè¯æ•°å­—ç­¾åæ‰€éœ€çš„å…¬é’¥.â€‹è¿™äº›å…¬é’¥æœ¬èº«ä¹Ÿé€šè¿‡ä¸Šçº§åŸŸçš„ç­¾åè¿›è¡ŒéªŒè¯ï¼Œå½¢æˆä¿¡ä»»é“¾.â€‹

- å§”æ´¾ç­¾åè€…ï¼ˆDS è®°å½•ï¼‰ï¼šä¸Šçº§åŸŸä½¿ç”¨ DS è®°å½•å­˜å‚¨ä¸‹çº§åŸŸçš„ DNSKEY è®°å½•çš„æ‘˜è¦ï¼Œç¡®ä¿å…¬é’¥çš„çœŸå®æ€§.

- ä¸å­˜åœ¨æ€§è¯æ˜ï¼ˆNSEC/NSEC3 è®°å½•ï¼‰ï¼šç”¨äºæ˜ç¡®æŒ‡ç¤ºæŸä¸ª DNS è®°å½•ä¸å­˜åœ¨ï¼Œé˜²æ­¢æ”»å‡»è€…ä¼ªé€ ä¸å­˜åœ¨çš„è®°å½•.

é€šè¿‡è¿™äº›æœºåˆ¶ï¼ŒDNSSEC å»ºç«‹äº†ä¸€æ¡ä»æ ¹åŸŸå¼€å§‹çš„ä¿¡ä»»é“¾ï¼Œé€çº§éªŒè¯æ¯ä¸ªåŸŸçš„ DNS æ•°æ®ï¼Œç¡®ä¿å…¶æœªè¢«ç¯¡æ”¹ä¸”æ¥æºå¯ä¿¡.

2. DNSSEC çš„å±€é™æ€§

- ä¸åŠ å¯†æ•°æ®å†…å®¹ï¼šDNSSEC ä»…å¯¹ DNS æ•°æ®è¿›è¡Œç­¾åéªŒè¯ï¼Œå¹¶ä¸åŠ å¯†æŸ¥è¯¢å’Œå“åº”å†…å®¹ï¼Œå› æ­¤æ— æ³•é˜²æ­¢æ•°æ®è¢«ç›‘å¬.

- éƒ¨ç½²å¤æ‚æ€§ï¼šâ€‹å®æ–½ DNSSEC éœ€è¦åŸŸåæ³¨å†Œå•†ã€DNS æœåŠ¡æä¾›å•†å’Œå®¢æˆ·ç«¯è§£æå™¨çš„å…±åŒæ”¯æŒï¼Œéƒ¨ç½²å’Œç»´æŠ¤ç›¸å¯¹å¤æ‚.â€‹

- æ€§èƒ½å½±å“ï¼šâ€‹ç”±äºå¼•å…¥äº†é¢å¤–çš„ç­¾åéªŒè¯è¿‡ç¨‹ï¼ŒDNSSEC å¯èƒ½ä¼šå¢åŠ  DNS æŸ¥è¯¢çš„å“åº”æ—¶é—´å’Œç³»ç»Ÿèµ„æºæ¶ˆè€—.â€‹

3. DNSSEC çš„ä¼˜åŠ¿

- é˜²æ­¢ DNS æ¬ºéª—å’Œç¼“å­˜æŠ•æ¯’ï¼šâ€‹é€šè¿‡éªŒè¯ DNS æ•°æ®çš„çœŸå®æ€§ï¼ŒDNSSEC èƒ½æœ‰æ•ˆé˜²æ­¢æ”»å‡»è€…ä¼ªé€  DNS å“åº”ï¼Œå°†ç”¨æˆ·å¼•å¯¼è‡³æ¶æ„ç½‘ç«™.â€‹

- å¢å¼ºäº’è”ç½‘åŸºç¡€è®¾æ–½å®‰å…¨æ€§ï¼šâ€‹ä½œä¸ºäº’è”ç½‘ä¿¡ä»»ä½“ç³»çš„ä¸€éƒ¨åˆ†ï¼ŒDNSSEC ä¸ºå…¶ä»–å®‰å…¨åè®®ï¼ˆå¦‚ DANEï¼‰æä¾›åŸºç¡€æ”¯æŒ.â€‹

## CDNçš„ä½ç½®é€‰æ‹©

Netlifyåœ¨è€ƒè™‘åˆ°CDNæˆæœ¬ä»¥åŠå¯ç”¨æ€§çš„æƒ…å†µä¸‹é€‰æ‹©äº†ä»¥ä¸‹è¿™äº›åœ°åŒºä»¥ä¿è¯å…¨çƒå¤§éƒ¨åˆ†è®¿å®¢è®¿é—®ä»–ä»¬çš„æœåŠ¡éƒ½èƒ½æœ‰ä¸é”™çš„è¿æ¥æ€§å’Œè®¿é—®é€Ÿåº¦ã€‚

```
æ¬§æ´²ä¸­éƒ¨ï¼ˆå¾·å›½æ³•å…°å…‹ç¦ï¼‰
å—ç¾ï¼ˆå·´è¥¿åœ£ä¿ç½—ï¼‰
ç¾ä¸œï¼ˆç¾å›½å¼—å‰å°¼äºšï¼‰
ç¾è¥¿ï¼ˆç¾å›½æ—§é‡‘å±±ï¼‰
äºšæ´²ï¼ˆæ–°åŠ å¡ï¼‰
å¤§æ´‹æ´²ï¼ˆæ¾³å¤§åˆ©äºšæ‚‰å°¼ï¼‰
```
é‚£ä¹ˆNetlifyä¸ºä»€ä¹ˆä¼šé€‰æ‹©æŠŠCDNèŠ‚ç‚¹æ”¾åˆ°è¿™äº›åœ°åŒºå‘¢ï¼Ÿ

1.å¼—å‰å°¼äºšï¼Œç¾ä¸œçš„å¼—å‰å°¼äºšè¢«èª‰ä¸ºâ€œå…¨çƒæ•°æ®ä¸­å¿ƒä¹‹éƒ½"ï¼Œç¾å›½æ”¿åºœå¯¹è¿™ä¸ªåœ°åŒºçš„ç½‘ç»œæŠ•å…¥éå¸¸å¤§ï¼Œä½¿å¾—å¼—å‰å°¼äºšçš„å…¨çƒäº’è”ï¼ˆç¾å›½æœ¬åœŸã€æ¬§æ´²ä»¥åŠåˆ°å—ç¾æ´²ï¼‰ä¼˜ç§€ã€‚

2.æ—§é‡‘å±±ï¼Œé¢å‘äºšå¤ªå’Œç¾è¥¿çš„è®¿å®¢ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ç¾è¥¿å¯¹äºšå¤ªçš„ç½‘ç»œè¿æ¥æ¯”è¾ƒä¼˜ç§€ï¼Œä½†æ˜¯åˆ°å—ç¾ä¸å¤ªç†æƒ³ï¼Œç”šè‡³è¿˜æœ‰ä¸¢åŒ…çš„æƒ…å†µã€‚

3.æ³•å…°å…‹ç¦ï¼Œé¢å‘æ¬§æ´²ç”¨æˆ·ï¼Œå¾·å›½æ³•å…°å…‹ç¦æˆ–è€…è·å…°é˜¿å§†æ–¯ç‰¹ä¸¹éƒ½æ˜¯ä¸é”™çš„é€‰æ‹©ã€‚

4.æ–°åŠ å¡ï¼Œäºšå¤ªåœ°åŒºæ•°æ®ä¸­å¿ƒçš„æ¢çº½ï¼Œåˆ°å°åº¦ã€æ—¥æœ¬ã€è¶Šå—ã€é¦™æ¸¯ã€ä¸­å›½ç§»åŠ¨çš„è”é€šæ€§éƒ½ä¸é”™ã€‚

5.æ‚‰å°¼ï¼ŒåœŸæ¾³å‡ºäº†åçš„å›½é™…äº’è”ä¸å¤ªå¥½ï¼Œæ‚‰å°¼èŠ‚ç‚¹ä¸»è¦æ˜¯æœåŠ¡æœ¬åœ°å’Œå‘¨è¾¹ã€‚

6.åœ£ä¿ç½—ï¼Œå—ç¾å¸‚åœºã€‚


## å¸¸è§CDNçš„IPåˆ—è¡¨

> éœ€è¦æ³¨æ„çš„æ˜¯æœ‰äº›CDNçš„å›æºIPå¹¶ä¸ç”¨ä½œèŠ‚ç‚¹IPï¼Œæ¯”å¦‚Cloudflareçš„å›æºIPä»…ä½œå›æºIPä½¿ç”¨ï¼Œå¦‚æœè¦è·å–Cloudflareçš„èŠ‚ç‚¹IPï¼Œå¯å‰å¾€https://bgp.tools/as/13335#prefixesã€‚è€Œæœ‰äº›CDNçš„å›æºIPåŒæ—¶è¢«ç”¨ä½œCDNèŠ‚ç‚¹ï¼Œæ¯”å¦‚BunnyCDNå’ŒGcore CDNã€‚

Cloudflare
```
# https://www.cloudflare.com/ips-v4
103.21.244.0/22
103.22.200.0/22
103.31.4.0/22
104.16.0.0/13
104.24.0.0/14
108.162.192.0/18
131.0.72.0/22
141.101.64.0/18
162.158.0.0/15
172.64.0.0/13
173.245.48.0/20
188.114.96.0/20
190.93.240.0/20
197.234.240.0/22
198.41.128.0/17

# https://www.cloudflare.com/ips-v6
2400:cb00::/32
2405:8100::/32
2405:b500::/32
2606:4700::/32
2803:f800::/32
2a06:98c0::/29
2c0f:f248::/32
```
Gcore
```
https://api.gcore.com/cdn/public-ip-list
```
BunnyCDN
```
https://api.bunny.net/system/edgeserverlist
https://api.bunny.net/system/edgeserverlist/plain
```
Cloudfront
```
https://d7uri8nf7uskq.cloudfront.net/tools/list-cloudfront-ips
https://files.imunify360.com/static/whitelist/v2/cloudfront-cdn.txt
```
CDN77
```
https://files.imunify360.com/static/whitelist/v2/cdn77.txt
```
Fastly
```
https://api.fastly.com/public-ip-list
```
Keycdn
```
https://www.keycdn.com/shield-prefixes.json
```
quic.cloud
```
https://quic.cloud/ips
```
Google CDN
```
https://files.imunify360.com/static/whitelist/v2/google-cdn.txt
```
CacheFly
```
https://cachefly.cachefly.net/ips/cdn.txt
```
Akaima
```
https://techdocs.akamai.com/origin-ip-acl/docs/update-your-origin-server
```
---
**Done.**
